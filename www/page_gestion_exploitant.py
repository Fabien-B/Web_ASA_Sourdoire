template = Import('template.py' ) # import du fichier template (entete, pieds de page...)
connexion = Import('gestion_session.py')
releve = Import('releve.py')
exploitantfile = Import('Exploitant.py')
parcelle = Import('parcelle.py')
compteur = Import('compteur.py')

def index(error=''):
    ret=template.afficherHautPage(error, titre='Gérer les membres')
    if "login" in Session() and Session()['Id_exploitant']==0:
        ret += corps_page_connecte()
    else:
        ret += corps_page_deconnecte()
    ret += template.afficherBasPage()
    return ret

def corps_page_connecte():
    html = """
        <div class="container">
            <div class="sixteen columns main-content" style="text-align:center">
                <h2>Gestion des exploitants</h2>
            </div>
            <aside class="six columns alpha">
                
                    <select name="idContact" size="10">
            """
    html += create_select()
    html += """
                </select>
            </aside>
            <article class="ten columns main-content" id="infosexploitant">
            """
    html+= "LOOOOOOOOOOOOOOOOOOOOOOOOOOOL <<<<<<<<<<<<<<<<<<<===========================================================>>>>>>>>>>>>>>>>>>>>>>>>>"
    html+="""
            </article>
        </div>
    """
    return html

def corps_page_deconnecte():
    html = """
        <div class="container">
            <div class="sixteen columns main-content">
                <h2>Vous n'avez pas accès à cette page</h2>
            </div>
        </div>
    """
    return html

def create_select():
    html = """
    """
    exploitant_list = exploitantfile.Exploitant.get_all_exploitants()
    for exploitant in exploitant_list:
        html+='<option value="'+str(exploitant.id)+'">'+str(exploitant.id)+' - '+exploitant.nom+'</option>'
    return html

def traiterFormulaireConnexion(choix, login='',password=''):
    return connexion.Connexion(index, choix, login, password)
